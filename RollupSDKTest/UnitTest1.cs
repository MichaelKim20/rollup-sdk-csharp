namespace BOSagora.Rollup.BlockChain.Test;

using BOSagora.Rollup.BlockChain;
using System.Numerics;

public class Tests
{
    [SetUp]
    public void Setup()
    {
    }

    [Test]
    public void TestAmount()
    {
        Assert.That(Amount.Make("1", 0).ToString(), Is.EqualTo("1"));
        Assert.That(Amount.Make("1", 1).ToString(), Is.EqualTo("10"));
        Assert.That(new Amount(new BigInteger(1), 0).ToString(), Is.EqualTo("1"));
        Assert.That(new Amount(new BigInteger(1), 1).ToString(), Is.EqualTo("1"));
        
        
        Assert.That(Amount.Make("1").ToString(), Is.EqualTo("1000000000000000000"));
        Assert.That(Amount.Make("10").ToString(), Is.EqualTo("10000000000000000000"));
        Assert.That(Amount.Make("1.2345678").ToString(), Is.EqualTo("1234567800000000000"));
        Assert.That(Amount.Make("0.0012345").ToString(), Is.EqualTo("1234500000000000"));
        
        Assert.That(Amount.Make(1).ToString(), Is.EqualTo("1000000000000000000"));
        Assert.That(Amount.Make(10).ToString(), Is.EqualTo("10000000000000000000"));
    }

    [Test]
    public void TestHash()
    {
        var build = new HashBuilder();
        build.Update("abc");
        var h = build.Digest();
        Assert.That(h.ToString(), Is.EqualTo("0x1a60c38bbdf04315e5d12747a45f7e02d9da3ea6e7dea87270e4acf8c900d110"));
    }

    [Test]
    public void TestHashInt()
    {
        var expected = new[] {
            "0xd86e8112f3c4c4442126f8e9f44f16867da487f29052bf91b810457db34209a4",
            "0xf0a0278e4372459cca6159cd5e71cfee638302a7b9ca9b05c34181ac0a65ac5d",
            "0x6cc16abd70eefb90dc0ba0d14fb088630873b2c6ad943f7442356735984c35a3",
            "0x5eb6da0e0e522104c6d50b0748e6893762f7f2c00a7163a46ccbb535bfd61a0d",
            "0x9d4ac218fb54041e3a70a8e14db1ea1af9f570f4842b4702ef9323f1ad8f0ec4",
            "0xa06f129fc52abf6085679d7cd71dc41ec7580c7f5f73efef6d02dde22bb00994",
            "0xb1b0bee5378188f5250138bcce25855f2617f9c55b20b9628e13d367c47404a9",
            "0x2e22fd435060cd5d3cf5e3ef39f79e198b35bd2c4af31974db36601b3a2f4c91",
            "0x01f629f0807a547c90252f658557d888852aec7555ccbdf041134e56a6755ede",
            "0xfef02424157f106b48d04276276c15ebba9c516e6024d4f82ea2f648af3e09c8",
            "0x8191cd68605104a22123bf9c69bf764bd7afb3053626cdb1eec15185dc20f1d8",
            "0xa02ae51509464de11084e34346a86574191b861de2cb5cf064661b459c9bc9e4",
            "0x4c6d7e0c6891e6a9fa287ec16b85caf8bc7b4cf40e3d750591fb47e7e0403a9b",
            "0x46386ff0eccd7a7871daa3122b418bbf8e0d0180eca74808a53b2c3ed970f50e",
            "0xb54b1a339e9f1b672af88b397362d05c99e30d790835dbfd74fc9117a6de76d3",
            "0x41b8f24b79ae38bb5f3af44cf187d022c20517a6f576791e466d536517b68fb9",
            "0x446bfbd9ec163187d37929dc2e44cc86f8403d574c2d841c9a5e4f3b5a0c20e3",
            "0xbc7b86391ec13f09bd713e946eed447ea6a4543d19e686d71489783bd20898f2",
            "0xdc18a1ce81873b758e5d4a7809a900f8f971478008443297fddf46570605a1a2",
            "0xc6e8790d2e2c7e9d9e16dbd7f997d8fcf9f811b555c337a50ebb67de69b62f12",
            "0x291f6b4fa86b5fc9fd6e8a420eb811c2bf16f2db788344ba3eb0993378773e51",
            "0x0854082c3b0245f7e0f1cc127fe74d2efe6a72eaa875378afa350adba710186d",
            "0x4513a1a516fbf1cb042bc78f9e9c4861a91aa218294f81230d0dcd0abdc84648",
            "0xcbbc48750debb8535093b3deaf88ac7f4cff87425576a58de2bac754acdb4616",
            "0x9ee50aea7e52f17dc807488bbd631e368da3a3ad3d5a31ad4b0f049581366c4d",
            "0x525c3368aba80a606f181bd81ae58ae0cff8a52d05b47ddc01c0c3d1273397e4",
            "0x0473a26b7f2943c75581105f8c9c0b7d51189790b021b2891e9cbfb7f153a725",
            "0x01234566814cd2a2b3cd7c19c907964b4a4f018a19ec224788d9edb74d7376df",
            "0x3c7cf369c7034e44a5615efaa51cb525ad1db86dd1b3547b40625fbcd49a9987",
            "0x3e990d45c83fa01d9bf0c64b79ed7678df3c723614f0f7eccdc3d196fa3073e9",
            "0xa9765c4805658a968e5abdccd437e25907681a1cff6375e363239c53b125fcd4",
            "0x01acecb507abfe1a354aa8064f4af5d3f1acd019e37db3c11c97523b71c76e9d",
            "0x2fcd151b8295e8b3bf8ec64ede173523417960a8db6cbc569de9a25a458f9135",
            "0x1b03ab083d0fb41e44d480f48d5bba181c623c0594bda1aa8ea71a3b67dbf3b1",
            "0x7b742c398b1a841a160d67298c4e11857acc1db71c3f90509722ca74733cb814",
            "0x48443c868f27fd5d4e1749506108b7419f6c508bd93fa3cb4f99b5745241e476",
            "0xf976b84a6792a2ba0959787a04b09482a1b8c68d44c7aefe7751b1b66629e0dd",
            "0x94039884329d3732c577860f40d0dfdf883ff89dac332f87216e692c08892fa2",
            "0x22f23252fcd4f43ed48d75ca5e7323df657fbff031410740d914a01433e7580f",
            "0xbe58233c8b1c33d2911eccf0f47364922b872acca2e95e4423bc21820b59ddf6",
            "0xbaf00e0b9e04a2563ee664311136c4f84d22d5790ea9171c344e6093d6b0bd12",
            "0xba4c2184969f64b5ae56cb8dc6e006847a035b05ca46cf40d7f87297cd21ee5c",
            "0xa35ffc7906347f2497cb66ab04abf16fb27d3f81a85f9ab9e556adda77b64b3e",
            "0x3871debeb761105881f03cb15016744820fc7cdd6f30bb5348817d0df01d654c",
            "0x270e67d6266e08628bc27ec405e4cbaf41b29327111583ee3fb7b99c48abff3a",
            "0x45055f7d65263fdd23060bb67886e2269ca996e23f5d9423ee2c445432dbfe73",
            "0x763cb06a4315ce67ad6ee034881011a548eedb0305b72fa0196cc012b4b834e0",
            "0x30e06038fb18a7cfda688d7bfe8de1ca8fee6002c5b4a498e6993a3592e88893",
            "0x05fd9a4fe5300d5c32df03a2ddfe7bb2ee35cce3e6df750bccaf4f2b32b737f8",
            "0xf44b28e2244100cba558060065aa621e982bd6987a9ded05095b6047270d9b21",
            "0x7df7e25947701db963590b170f230b1fbe8e5e5a0d8e2419e523b952bf4070c3",
            "0x0c52f6bb94d3274750db877dc62419e6279cb01d306327df7901e784d2e89536",
            "0x20229cc185e48c4102a795a3f2bc7b87d24a8eacc1bc479a196641d83ce8c8e3",
            "0x68c39f89cdcb51b306cbd9f1c6b135791f9806b6c05f0ccc9c6bb8444fb0ad17",
            "0x24b5d6e79d4d3dab7575da7f0beceafa9281c19295c6ce5ab31951db761ef188",
            "0xcd2662154e6d76b2b2b92e70c0cac3ccf534f9b74eb5b89819ec509083d00a50",
            "0xcd04a4754498e06db5a13c5f371f1f04ff6d2470f24aa9bd886540e5dce77f70",
            "0x8005f02d43fa06e7d0585fb64c961d57e318b27a145c857bcd3a6bdb413ff7fc",
            "0x4c0e071832d527694adea57b50dd7b2164c2a47c02940dcf26fa07c44d6d222a",
            "0x998e907bfbb34f71c66b6dc6c40fe98ca6d2d5a29755bc5a04824c36082a61d1",
            "0x707d56f1f282aee234577e650bea2e7b18bb6131a499582be18876aba99d4b60",
            "0x3f710ac088db33363087de2b9a657541fe5447821debaa9fe5cbd538eb1a5f29"
        };
        var build = new HashBuilder();
        long value = 1;
        long m = 2;
        for (var idx = 0; idx < 62; idx++)
        {
            value *= m;
            build.Clear();
            build.Update(value);
            var h = build.Digest();
            Assert.That(h.ToString(), Is.EqualTo(expected[idx]));
        }
    }

    [Test]
    public void TestHashBigInteger()
    {
        var expected = new [] {
            "0xe52d9c508c502347344d8c07ad91cbd6068afc75ff6292f062a09ca381c89e71",
            "0xbeead77994cf573341ec17b58bbf7eb34d2711c993c1d976b128b3188dc1829a",
            "0xc555eab45d08845ae9f10d452a99bfcb06f74a50b988fe7e48dd323789b88ee3",
            "0x36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068",
            "0xc3641f8544d7c02f3580b07c0f9887f0c6a27ff5ab1d4a3e29caf197cfc299ae",
            "0x76be8b528d0075f7aae98d6fa57a6d3c83ae480a8469e668d7b0af968995ac71",
            "0x47dc540c94ceb704a23875c11273e16bb0b8a87aed84de911f2133568115f254",
            "0x99be5efb88ca2013bd8e4eb035fd42d5245468fe9afa70d8ba9c1c419a48c4e8",
            "0xc0ba8a33ac67f44abff5984dfbb6f56c46b880ac2b86e1f23e7fa9c402c53ae7",
            "0xe545d395bb3fd971f91bf9a2b6722831df704efae6c1aa9da0989ed0970b77bb",
            "0x707bf0b938f307b5c222e670598b865d5e1f8a8003df82c7abbf7c9f8fa4d720",
            "0x869f1dfb999a452f497a4cf7f44db2d6ee661f74a9e7e05251bc1420e50672d4",
            "0xeec4121f2a07b61aba16414812aa9afc39ab0a136360a5ace2240dc19b0464eb",
            "0x8509b81230019d2ad970d970f791dfbdc8caf54f5c594fcd327cef9feed206c1",
            "0xfb50dc0717ff266cf9baf82b1ce7a1c2ef6d9247859680b11a19fb7077f5f222",
            "0x070b13c004e9475fa155cd84d90de9f87db1b7dea6707329638a6ce66043d246",
            "0x3ee0d7c44a58950b18c1e01b912ed0e08549ff905fbf7010318a44d3e2efb8db",
            "0x736722f22cbebd49059bbc5d24c1bf71acabcabc8a4ba8d3776392d54728dc91",
            "0xb3e5e46cae04efa2320a4a5febe7ab238c01d08d2a5127685ed9d92e359a5517",
            "0xe1e9fd6516b9e31d562045e87cc560d22e231325c06db30a98e6035c5d51adbb",
            "0x59196b420f2e7dc694cfae3bc460c6c79e035260b5d71c3bd006f30dd5330a6f",
            "0x25ff297dd78c82468376d6e2c93b672b49c01fb125a2812b94f8f9693a51b67e",
            "0x67abdd721024f0ff4e0b3f4c2fc13bc5bad42d0b7851d456d88d203d15aaa450",
            "0x26b25d457597a7b0463f9620f666dd10aa2c4373a505967c7c8d70922a2d6ece",
            "0xfb5e512425fc9449316ec95969ebe71e2d576dbab833d61e2a5b9330fd70ee02",
            "0xdc765660b06ee03dd16fd7ca5b957e8c805161ac2c4af28c5a100ab2ab432ca1",
            "0x097328e8c957de2428283954f6a1ee8ff7ad7def12e100a600178407f5decf24",
            "0x8d71b3faab8201459ad37ef499beb336ba88bdcfa0f51ee6f0a46ec3192d750a",
            "0xc31425b44a7ed682a3356bf6820141e1584a15c43b6d6793f552e5d4621586f7",
            "0x50c8ba3a6170f0a2fb6736ece8a603576ef6309a35e810911599bc6211b554a9",
            "0x957b88b12730e646e0f33d3618b77dfa579e8231e3c59c7104be7165611c8027",
            "0x395c2f5598a1643a205154c6f4c46ce36895b28e6c35660a95e5c6fd5ef9aeab",
            "0x88420266dfd64d604627234a8a6c75cf6477c6fd5505df0d17c59959ae9ce234",
            "0x18b1b592a44f7fbe33dab6a3d22857eea5118da14d6fabbc59b0681dbf1286f1",
            "0x0f7e5b031a1706e40329c19e1059dca60f8cef74aaa8e73a911a414bc59e4907",
            "0xccef7d892e752044c89d5471eac8af79087c0e04e45c9ae566b05be88de30d1c",
            "0xe29949efa6efa258cd23e2da845d5e644863b3c507564e459175c5b847120713",
            "0xa59a1e12aeebf92cc16a3e78693369b32eddd86abeb45de07c072b8871c772e4",
            "0x36c159d76b52e03e496363607c5940227f62f4e048df344b050159bc97bba3d7",
            "0xc05d231da83665dd60560fc424059d66b433774afcff4d3b053b407f057d54ba",
            "0xcd41fef213afb1de08d204b0122e1053826da686335fe6260aa6ed620764f820",
            "0x2c570cc065bbb1010b10d2935b2f11bd01b1c250e19e4ca9cd8b5dfb4a26c92c",
            "0x1ea445a85d9fba03f0d82ca738a4c2e218b43a84aa7ef19451b3c816dbc5ffae",
            "0x504e04037e15a33413b6f943a5d90fff2d57660363f019162c7f5120bc33d7ae",
            "0xc73eb0b8c6e1888546b411bd694fd9d96d4b11b1920d11177699e8562167d5ca",
            "0x38d6004bb0690cba7f439b2f8df6d6b8c2aca38220198ab83a69d42d3fd1fa03",
            "0x847b68e04850722a806bb44550e8c03218f8dfac46c78fd719ffe1303f915b60",
            "0x8c25daedfd927a09d77d8398fd409f4c8a522ddf35a7b9d2200ca5dbda4181bf",
            "0x5aeb86de70b0064ebbf77be361a12159d7e229e2afc504ae106d1ee3636c9777",
            "0x071eeca6d306dcb3312ddc6f4cee1732d41680266fb071460aa3f4a0dd504c8e",
            "0x5aba06a74a66fb57aa4abe9f435ee70059b86d09a89fd9c617ec6ee79c9c2446",
            "0xb2de8f5237d7fa1d40cd50750be52b7657edca5d20741dabf9e6d9ca69ecda91",
            "0xf2196d43e3c8a3619610293f432dc2592488b7ef4ae1050222eec6e7d175a231",
            "0x8797636b941d0080dca9ff53dcff04c06cd59e37366d4dab6e24570b4296a534",
            "0x7c9fa136d4413fa6173637e883b6998d32e1d675f88cddff9dcbcf331820f4b8",
            "0xd86e8112f3c4c4442126f8e9f44f16867da487f29052bf91b810457db34209a4",
            "0xf0a0278e4372459cca6159cd5e71cfee638302a7b9ca9b05c34181ac0a65ac5d",
            "0x6cc16abd70eefb90dc0ba0d14fb088630873b2c6ad943f7442356735984c35a3",
            "0x5eb6da0e0e522104c6d50b0748e6893762f7f2c00a7163a46ccbb535bfd61a0d",
            "0x9d4ac218fb54041e3a70a8e14db1ea1af9f570f4842b4702ef9323f1ad8f0ec4",
            "0xa06f129fc52abf6085679d7cd71dc41ec7580c7f5f73efef6d02dde22bb00994",
            "0xb1b0bee5378188f5250138bcce25855f2617f9c55b20b9628e13d367c47404a9",
            "0xa536aa3cede6ea3c1f3e0357c3c60e0f216a8c89b853df13b29daa8f85065dfb",
            "0x4322fd2bc0a137d1375b37b3b2e2b4715b3d3dd7ca9682438d4fea0f8437fad3",
            "0x93e60f669b99ad3e3ee6284b139e57adfb419960f390858e46ea565bbf82d001",
            "0x92c0a3cd8b571ac5634aa066fcc63d7b62155c36126a29231d97692ff2944875",
            "0xba80c236eb51b48f327f8cce2664b5556634c6ac05b50a7b163d9bfd7417c459",
            "0xb524830fb1b95fef6024db23ac1d140a0f5ffe64907f0049e7378d0743cdf946",
            "0x6c744aeee3965d5ca100af20be7c69eeeb6cbab990cabdaccf39ce4f02e3fd2e",
            "0xc6af91d6f586c94480bd818a240601e864b1daa9f0df4a16a6976d44ffd3a99b",
            "0x96eeff563b3135e3f77964e8c062328fd207c8bc9e754fc423abaf83eb3f1490",
            "0x337a32712f14c5df0b57a64bd6c321a043081688ecd4f33fd8319470da2256b1",
            "0xab0c4a5b8bd8ee364e1e638e7d81465a8f4ffe9a8da3f2494962622b72ddc2b4",
            "0x66bed744dab31123cb725b00788d391827d287fbae8d3c7a9316ab298958de10",
            "0x816f8bab3a2420f412421c2dbcdef0bfcac325b6525c2be1a9e5e9248dacf542",
            "0xf4fcfe589f7a3ea1ba7f0d787f9637c9902c95c9793e3c730cb6c1fc8f86a63f",
            "0x94a78a826daedb9abaf3f4e76b4dba32648b66723813c087e097a6c73cc1dfe2",
            "0x00f1fc659224de3cf33ee4d5314aac08c1ca62feed06c7fd934fc3384056e738",
            "0xfd1b99579c88a4f533613a38dd643f7bd7e6cf97feeac1c95a0d90e68d7ae3db",
            "0x5563cc1568e244183804e0db3cec6ff9bf577f4a403924096177bf4a586160da",
            "0xc6f378205327fa9e8eb42cfdbeff1702d60a5fbf5e1a909ba6c6ca0ecd971907",
            "0x2dc4b8690f5213d4d58ee9f2faf82a5643ebffe8f6ec2eacb01836cd430ab83b",
            "0x40e749384e73d603c41c1370fc839844583ac0308271ffadd3bea47eee46a3a4",
            "0xaa1be21430bf72a6336ce88db78c8708b56136ed6939d3e077fa7bfd6ab70e12",
            "0x8ad01cb0d25c17b26198f752c52b10033714483a680f17bfc9fce222b150d301",
            "0x1bfa952568325af1269f0531f785e5692840c780522e19907f4d2c841f62ff74",
            "0xca888f40c3caca805b37a5434c75de5550616e0795e7602fb91156f22dd90851",
            "0xb76875c50ef704dbbf7f02c982445971d1bbd61aebe2e4b28ddc58a1d66317d5",
            "0x1acd855e4657b0c3f4e203d3452dbfd1cf66eff0101b0ac539f0570f06990f9c",
            "0x958f8e67d123a4fd3942a588a4447f781501af6120487ff147b2cef0e5076421",
            "0x92ee0b61bd440fd8cd31a7b58b3a591d5f088e9bc165200777a958dbb18c520e",
            "0xb8ee8fb630031ee9ead1e51f0d904df0d379c7b079de43543624b87a430be89e",
            "0x85cf635cd7cd5fa08663a65dafc102a262844c362971189af855031e0a2c09f9",
            "0x9f66dac246d827e79724315f0d4e4ff53ed5f9138903fd80457d0f61fcea49e3",
            "0x8150a65e854b9bbbd52eefd048eb025c76fe48f0475c0f942c9db9eda40a94c3",
            "0xedea17609e561aacc378a28195dfd3fd8916a95b3f4334b986fe0aab9bc87565",
            "0xf99bf80562ac8104e5a7c0b0d63d9348f57d12be0c577eb9281780cf5311793e",
            "0x03b3874624d6f0a588786e00e7c1e2d3afa9716f3fb963ed1bd59a4e10dbf301",
            "0x56b1c14fbfe56689b68b4fb562097e43e3b36f99da02aad5da67b4257bf8ca1c",
            "0x2e99eaa358fd245b20cb38680a8e48caf69d00f6c9645ea161c3be197dea5bbb",
            "0xfef5280f23157feac12dc78de1ba613036707ed766249bb37a55c7c17d7c96f4",
            "0xdaf2573bbb235d7c8579eb31f63dff1e57f0bdcfdd0504bb3a0709b2b8b4aadc",
            "0xdabfa055e3f81b988a9d63b35c282c4a9962367f72a502826975ee7c2e178ab9",
            "0x029d766abac9f78f05d52db9abbe1dbade88bac6f952e66bb1ed1af2213e6a0e",
            "0xdc4a1bd02f8f4452847e329d3ce6a05ba8917f42f32183cec890554187dce714",
            "0x5a3f64f6652d1511efb91a1e3644c7b77b04146aaa78bdca2ce9932b847d764b",
            "0x5d63b0e017eb1ecdf146e007290e7dcf9810718f825cd453f4c40448a7ebaf72",
            "0xa9bb6d8b02f00afadd4da0576f8458118f7e432abddc894ae5f466839b73a5be",
            "0x6ee23a2ef7729da909139832912581a3b835fa221797e5b20c6d2c06ea51a9db",
            "0xa1a356e2cbe7c39ad129fbf838d08aa88f943b9d492c0e513212e89b6871c4ce",
            "0xe4e7ae3760c6a55c7d504bcbc1200faa4e1acd6b32a694d4f4f51d8cfbec8a12",
            "0x47ee209e470e310f5754aec8acf25f58675d375201910c7cca0e68c71192fa44",
            "0x55bbd0111c33f2fed3f7c7e21e1269279fc8e0f87dff84b8ea31eac20f848cad",
            "0xa7ac2a3d818c0d89d452325adaa2ffc4df1b2bc26b93bc6e0205f6293297656c",
            "0x5ed87d3d9168cd5a6f00240b5acd3467d78171e408bc25450ec78905881d3281",
            "0x1a855121e9f4ee4f14662d18931c492008b84b9041936fa15d5e2a52eaa9fdf9",
            "0xd3080902456ce5c6610139130db690387105f44d4cbbe1aff1cd7a8d1d20dfcf",
            "0x4d2347e1f114c6eca8118d2039055ffb661739eb30e5c7c950def14418fd9827",
            "0x4cbbd8ca5215b8d161aec181a74b694f4e24b001d5b081dc0030ed797a8973e0",
            "0xb1535c7783ea8829b6b0cf67704539798b4d16c39bf0bfe09494c5d9f12eee30",
            "0x6b6f14e6af2627186bf8a55e474dcf6ef3f6ce81af560da871ec51eb670171a9",
            "0x85b724e3f6e2dd2648a696595eb637b234dcecc5cb770a5afbf0926341ebdfb4",
            "0xe6525ba6cc636e73aeaeed22dc8091a705155755497952a5f150b5a508e00a86",
            "0x1349a3998807d01fb1bb740088944fed74363d610079605f89fdb9db35e395fe",
            "0x02c75b9703b2bba7438368af386588470281f02e7d07a75b95f94826f3e7d184",
            "0x3c79f1b5ca0a59275ca1b3236f81b5547ddc9dfca6a21236d85ef63060aaccaf",
            "0xf0d278eacbee4eeac1f3cc75d5efda8dc5dff129bed3da9ad3b0e11fc64ae910",
            "0x401da6ea6a614dd6d773b1ba84c91ee6d981827bd0bdc5188aa2e5dbffba558c",
            "0x48b9b34b851a03302c02d0519a1b741babdbf7e4dbabf93c7a7f1ea7db057e7a",
            "0x7dba74d56c569badde34f13dbe81c8bf3294a8a22b672aa04746c52ec9a6bcc5",
            "0x82830c09e49f57e034d2254494f5363ad00db13849ac383e0a05769ddc2940d6",
            "0xbe273a279a5c33b929b55947ab54f7ecf10dbf008f720b4cbae4f2d76ba2f34c",
            "0xc53ea70e23163593f328532a2a41cb5ce0a4948fd3143753f0e5eb51e03632dd",
            "0x8befd28c88ff846df05e6eef05bde522f601bd98f71b94f9c8aca41bc9f559f1",
            "0xaa25e1d595a77c375b40b4796ea4ff044890efeebd4bd15d16d54387a5a8fc37",
            "0x3892a88a1c454d52a2383473b4827cbfdb1100ef18149781609c4851ae54c0a5",
            "0x4e10b2eb798ae350fe3c08380946b992fc6c8b6c0e9bed6e44ef2dedd0d5ba21",
            "0xba2ff2cbe4067a30b19b66a90e13b139f77af1e3c62c430b7f5a50640d62aed8",
            "0x387956f803283e0c6fe3cbef455515693e0501017e4edb5bf039f9f14da8c9ea",
            "0x3bf01b23d1033c97fab8947a244a31f1023ebea3554e1d69e04519c60bf326ce",
            "0x38acb4ae3c197fe001b7f5a27fab0fd6504ba7c06a91e7970d6089ab70532987",
            "0xe1e6087b6c0e47331ee7b47073c67db83a0ebf903181b9f214581cef0af91f4b",
            "0x25dd4c1d8bafcf4932a135ca2d80c43efd747e72f5708e41d954ce34f4693b8e",
            "0xf05b8825fd220b6d61b948e6f675548e4d2284fed9b46e11e775e02d8f302f93",
            "0xeb9fed46e6599b21efa56fcaea76fef0e48852bea1dfcb7c0a5d2331b935b92d",
            "0xfe621e6de5083367b787fc2f067eba02c014331f265f8f40ac6b76a4bfe3a9cd",
            "0x230dd1070f811be9b42ac1f9f68776dca210f7409dd15d27eabaa2de5ab21494",
            "0xffd614529e93b3c050d554d4420196700af78ab9bfbc79e719f3d24ea4b579c6",
            "0x3c8f980adc706dbd6efb870541048ff9ee2729a81bec73e7d7759d69660ad3cb",
            "0x27296835d2cff9d7f55e6d0c5e43520a3e14db22e32cadce353bce3cfca6198e",
            "0x21fc3f955c14305ed66b2f6064de082e8447f29048da3ab7c5c01090c1b722ab",
            "0xc75eeff218c4e3c7142fc8c157817d0bdf537b3446164e4fc26453bc42c4c62d",
            "0x54f0a7cee592a382dbeb08135d279191ef275a94072b8dad6a93040cb59f709e",
            "0xf29ef2b2119bdb718278a56a272a485e0a7b4f4820ba94cd650244087d9b1143",
            "0xc01ee2247c43b3c6e7af7b3f0bc549ad0e112016304b9cfb1b991617512865db",
            "0x27c903084979dd5a21a936d6d0e653200fdb698cae37dfb1d42a43f80f83b263",
            "0x91d67eaf92f45d65aa7ed602ea04c17869ae39a9d46c32cc91146870e4e518df",
            "0x679b982579f0c151aaaaa2a2761be8b8b0ec22eb9028b72f14a8eba3a4429512",
            "0x10c7b76c881edd80616f48eefded8b9e7fe0f4ad52df3128647365be7e21b4e0",
            "0x5128c57db27840ce9edbb49b70453386227c78f9c9fc5f17a40af4df55f46f9c",
            "0x336eadd40426c055ef3b04db556f6f1a570d3de71fdf4b27fdbe385ae7d84cf4",
            "0x1fc242b200f679398cd6b10ceb6fb1e479c508d65af3a5f6c38b1c0c57074215",
            "0xfab41327ae95baa5b9de4a5312d3c30ae3d3d9006054d20c7a8650dd188eba0c",
            "0x405bc081f1814af4e70a4b89c1b792e81c208097b2b7cd1f4e9fe8fa24484783",
            "0xe5b72ea22164ec5b719c372b97f95b74744a11e9f9cc31a68498ee015ddf25ff",
            "0x156dea3f18a774aff047ec978766520d0a0689487b9bd48c5c1f297b48378708",
            "0x884998df6a91f27eb4284624ff8c5c35bc6888dde0b3bbaa01d2b631240b8cf4",
            "0x8570a6a4c9b398777b1253897b94d6ff0f60d39e3a06144aab8a394c1ce51f37",
            "0x5474a3a41a922c41cf3879e701be8007dedbdc84e5536b0e689a02fe5e948ff9",
            "0x0f00ae77c9408c172f2356224a7e0545d34e68f38b7b8001a3ccd466a0f2b14a",
            "0x7b471283d7569df53037456cadee9b3267671609194728c0d1a01059c8f85dfd",
            "0x6b41cda9e0fc7df5a20a955d963af6a7c89279ba22e363019033603c5c903c8a",
            "0x81b987a04971bc0067838a5c5483dae37ab3e6fd2fe3189abbcf7970eabc4801",
            "0x3f81964105aa8b8ef46edf5b9f4a0687fd53d6cabc55cc4b14b58e4ea53ef77f",
            "0x779c47f7785ef00107abf0d815c9c1d1cf359dc0f7cf1d0e0c2072fcc38d9fd2",
            "0x5adf82d02a983a2c689d510c278802b375c805c773f561adc697deeb2a700212",
            "0x884d7c3855d0461bbe3290e748cafef3b11b06955f1082890af08581683f18a2",
            "0xb0beaa2999275b6e450f96bb20fef0361dad82cb6e80c747031a530a690752f3",
            "0x0a640f1fd95015deaeca5cb12791292262d84a4fc31dfacc4e8830fef9a0010d",
            "0x085bd971b5bd803629af537901836481bf9325844a060f2235e870af5bb9a282",
            "0x877268b4c42c5fd2895cffcda2e79ee4fe1ae73f71b11140bd4a598002ad02d8",
            "0x62201fcff8318868e251dd7c46d852003148a9e664553039a5639e1e82976be5",
            "0x32edb6022c0921d99aa347e9cda5dc2db413f5574eebaaa8592234308ffebd2b",
            "0x2d806c3c07145b3d72fd9285c44618c26e9ee3b5b3a8affad1b57e7850599999",
            "0xb97f04a7b2553ffe229deb26f42ff91ee2eab9e5f91c5761f898e52f8d7e5a2c",
            "0x083d0bb345c114af916e5bda2ff5495753db646c52771a1be48cb3ffd449b79b",
            "0x7a06e4e6da128e3f3b86519181c45d4fea1677eea62c1fadebb281892e650331",
            "0x63c22b7c907a7e949cc5b8c132a8e021ce6e9d7f839aa521faa6fff2785ee349",
            "0x6e05a0e22cfe351fe6ce13b16ab51062b2d82a0300a61c237fd3363360a4481c",
            "0xa4ac0e497216ff986841e4ea6cc54c229dec90023f6517bd3b2a495eb3abfdc0",
            "0x6bb0f5246ac6ee3fa6a6879c512f393f05348f9cbb2144fe34dc8a8a4354f208",
            "0xd3396282a06c23f48a71004c78b303313c88dbe217546ed7388710046bc74b43",
            "0xfd5a58a1b19d537e2bc4acfb862e9ab5479c1c9b9c0fd47f67634378960e050f",
            "0x867812d34ebd6b7b3c51a77d5c11efb742006255ae7610d0cdf0d74e90f8a11a",
            "0xc96340c91a20cacc0bace9de4493f8c64bc1ba625a87adc5b36905e0d63c3594",
            "0xe7abf050952fc2ac85fa8f29169fe7803e936edfe4ed8572cbb5ca99a4a43508",
            "0xe37c780e3d5ddc4057d97a01bc99e1d5e0dec89b0cfc07a3de0361e620e7fb0d",
            "0xf40010c8f177e88425e0a6897e335f7574722618ceab7e00145dbbdc01fc7a50",
            "0xb9ea956f14d8b7c3d95237432924142806c87a3be0972fd816f186c283adba9f",
            "0x5b27a7c2167b3a252eb5e9de227d2aebd9c7ff62afb0af65e36490c7aa4f9048",
            "0x5477c926c8ddb19ca8fd71c7a1cb24dc02f271c4e5a4103412f1edc4b24696cb",
            "0x37cdfb278112dca0efeee47beeda1e8ef4fa9c46288e1be3170cf74e7d23f34a",
            "0xa78937d0113e1586b43d0f3413962e2aac206b015cec0a154b81e7d06fd0fecc",
            "0xf313cb260282eb6918a51430bbd4b3c4d70573983240a7de9014a0fd840f48fa",
            "0x4e073566f82e67df4da0f8d162b6c03945de511933b988d7c8f62c60b55206b0",
            "0x2540175861b274c1743b9609ea0c30d23c5c61ee50bc902365a15e05573a0e67",
            "0x8f92e33dda68ff39b21d04f54a7f5d96173282dbf47a45d9949bcea5eee4f787",
            "0xeb32fdb5c185de3af176b3f2ef3debec3be4ebf318503828486256eb1c9b0324",
            "0x0ab32b3cf86cada252bc89260a9936000defe8ee5e31e43b6997d0e0226c1b81",
            "0xb82b8e66548d50bebea8224e9af5d2ed6f86d4feef54de0d8a77ecfb2f5a4627",
            "0xe28eb8c555f0fa74bb36f01ce762f071dde5080f919484570f57f610676ee4ab",
            "0x9d9d9eab51abe2a56c9fef596401c49b99362ca916734632f265272a42ae920c",
            "0xd1646d79c1d01a55a88247e3cc8b975d50ba5b39a63b3dd060b1a72151272c79",
            "0x91b61e4c3ad1dd90f0cac9e6f4bdee52401eccf77a173635941285582a05b267",
            "0x895c607361d12436b3c82f8e233278f594d1de2ac032fd9534670a26f9bd5ce5",
            "0xab5ab9e4c79f911a85a2f07826c774cb2b338a48d185dd5d6b156b038c22cf05",
            "0xab47038bb8eca489b12929c58dbd78ef5c47a27641c7c07c268c8009ecd9676e",
            "0x2bca9353b987591f3592817a7eaf9aa3a06804b99c78a8decf15fe7de08f2292",
            "0xc83ccd4bbc77bf40ac93940b7c50496e89cb8ae4a86690515e88ac6830a657ba",
            "0x40d7ab173e683d216e8c593e407084fe6f875a3de2eecfb92e50ebbc251ede8a",
            "0x485c956c837f42168feac093047d30f77534bacf4b71fb63f5852f51d33d6b2d",
            "0x1055f16cbb449f4cb473d4b7615c46f27351f24889c193b9115f143e53a3ee28",
            "0xc997aef4f8b0a606938372e8d7d6645960ad71e9da45a448301add2a6927c0c6",
            "0xb2ab96098bda22ca233514f0e6b10cbb45b31a9a7c9de1849d28d8824ee080f4",
            "0x8a9ecd45da923d219695d2b87b1d12b725eff20ebc931a4d66f002b78f7ed6b0",
            "0x175fb9d3d55c86c2b036cd8b521c72378c6045df2837a1e2db42c6e2f6e6e6a0",
            "0x8f8972b980e11ee315ec70366c4d0d67624468f96fe6a89b8267ac3c2d475de7",
            "0xeffb0aa536359b2d67c56fd451c1dd25702d1575f38d12a0b4b15a3950eb642e",
            "0x871c3637b5d12acf1f50d3955c2873e1ac654216839dd26c756cf888e05fec2c",
            "0x6a67fe757ec784ae050c4d973f1c1e7b0e6445cf15992183afb6f1beedf58e32",
            "0x96af7e21333d4a0e7b127c893c72d496abee72218ff511a2f0d18c5c9cb8dd28",
            "0x28bea90c4c2f020400bab96967d374176df71c7ec633635cf974b92e82558e39",
            "0x393f0f645591618c46dfc6cf455451236db52bb9e0fca7ff3ee2db82c6e859c5",
            "0x251a1ff038b5028f0e9b242f0c89ee72f7887094f0ecb2f2b0b8423d39f458a7",
            "0xc436a9893264dcaecc39cf6bed434b974f13b0aaa32992fc1785d321fa64a6a4",
            "0x0ebead04bc36def44c2b168db6ae31fea9593bcf5800f0d193b136916a6c0983",
            "0xe613597e5ff8596abf378c0f04cef88c4f28138f601b3a3e705d171c5e1677c8",
            "0xc5234c952edca7b0f393ed7ecd7d6b29901c6d0a8fdb16e49e42ec4fe6ba7d25",
            "0xbdc3fafe93e6c473f44c7383a8681d8991fe71ec20ee172df82a527c8da61f0f",
            "0x68e8e360040ca6c18ec2da7d3e6c527a93084344f9f632d1c04403cc36e141bd",
            "0x42302579c53c6f39a0399dedfacf3218ad60684723613cd5e4acd43d46ec202e",
            "0x3f2529b941f7e933d37c9b215f061b4f049e46b9a77654c5be57dbeb58682d5e",
            "0xbaaae558401cc97d0ed56932551f9a25990342b0349e0ae009d633da05e3f09a",
            "0x2b3be43a4a427aa7dd444a41457d156ffc2d954c962d3e4e171c57a3633e1101",
            "0xb39541cc745aca93f2380f16f5b2c2e4777e9fc061cf6ab2209bab0b2406a79c",
            "0xe67ffd39b3fced2774354da5db872351003267f03281dbdb99160d93659d2072",
            "0x01d0fabd251fcbbe2b93b4b927b26ad2a1a99077152e45ded1e678afa45dbec5",
            "0x5778f985db754c6628691f56fadae50c65fddbe8eb2e93039633fefa05d45e31",
            "0x4b78063b9c224da311bd1d3fb969bba19e7e91ee07b506f9c4c438828915563f",
            "0x067dc6a810183e9069f63c2020b692c122c8d58263ed7f5c0e531504dc3b6e06",
            "0x56fd25956f759e64e853071ff01587c364eaf6286c97da600e0be78c701637db",
            "0x6d0855a335802f0bc20946f3c48c05b6b98c14b578020d5f42a166b97fe6f59f",
            "0x94ce3f7973aaed52c6c446bcc59bd8d43b6695fa3fdb9e3d1cc47503a432d3d8",
            "0x84b3f13b0a4fbcce4c3f811e0313e00dcbd27431c229eff576598be8d1afb848",
            "0x1a7dfdeaffeedac489287e85be5e9c049a2ff6470f55cf30260f55395ac1b159",
            "0x523ba5a7ec9362dbb08039a387922592ccea3dde63634480cd1b05b7bd50a269",
        };
        var value = new BigInteger(2);
        var m = new BigInteger(2);
        var build = new HashBuilder();
        for (var idx = 0; idx < 256; idx++)
        {
            value = BigInteger.Multiply(value, m);
            build.Clear();
            build.Update(value);
            var h = build.Digest();
            Assert.That(h.ToString(), Is.EqualTo(expected[idx]));
        }
    }

    [Test]
    public void TestTransaction()
    {
        const string privateKey = "0xf6dda8e03f9dce37c081e5d178c1fda2ebdb90b5b099de1a555a658270d8c47d";
        var tx = new Transaction(
            0,
            "12345678",
            "0x064c9Fc53d5936792845ca58778a52317fCf47F2",
            "0",
            Amount.Make("1.2345678").Value,
            1668044556,
            "997DE626B2D417F0361D61C09EB907A57226DB5B",
            "a5c19fed89739383");
        tx.Sign(privateKey);
        var h = tx.ToHash();
        Assert.That(h.ToString(), Is.EqualTo("0xbe8d68621ec431150e285249e4b8f2d16b97564da11a46211a29b822cabf0fdb"));
        Assert.True(tx.Verify());
        var json = tx.ToJSON();
        Assert.That(json, Is.EqualTo("{\"sequence\":0,\"trade_id\":\"12345678\",\"user_id\":\"0x064c9Fc53d5936792845ca58778a52317fCf47F2\",\"state\":\"0\",\"amount\":\"1234567800000000000\",\"timestamp\":1668044556,\"exchange_user_id\":\"997DE626B2D417F0361D61C09EB907A57226DB5B\",\"exchange_id\":\"a5c19fed89739383\",\"signer\":\"0x19dCAc1131Dfa2fdBbf992261d54c03dDE616D75\",\"signature\":\"0xc4aa8123a9d1c0e9d7a7d1763532016cdfdf0585c674919e7dd765c2df1f1b4b0ca9f1170aec0be013abd7d198713a8e6af7242f24228fe2cb0b727664ca86441b\"}"));
    }
}
